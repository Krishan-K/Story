hlw this is changes made in chapter 4 for master branch 